
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bifurcated Neural Network &#8212; hpiPy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/altair-plot.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=59fadc99"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=ccdb6887"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.20.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/neural_network';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Accuracy Metrics" href="accuracy_metrics.html" />
    <link rel="prev" title="Interpretable Random Forest" href="random_forest.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.1.5" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/hpipy-logo.svg" class="logo__image only-light" alt="hpiPy - Home"/>
    <img src="../_static/hpipy-logo.svg" class="logo__image only-dark pst-js-only" alt="hpiPy - Home"/>
  
  
</a></div>
    
      <div class="navbar-item"><a class="navbar-brand" href="../index.html">
<p class="title">hpiPy</p>
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quick_start/quick_start.html">
    Quick Start
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../releases/changes.html">
    Release Notes
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/reidjohnson/hpipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../quick_start/quick_start.html">
    Quick Start
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../releases/changes.html">
    Release Notes
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/reidjohnson/hpipy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Price Index Methods</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="repeat_sales.html">Repeat Sales</a></li>
<li class="toctree-l1"><a class="reference internal" href="hedonic_pricing.html">Hedonic Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_forest.html">Interpretable Random Forest</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Bifurcated Neural Network</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Evaluation &amp; Comparison</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="accuracy_metrics.html">Accuracy Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="volatility_metrics.html">Volatility Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="revision_metrics.html">Revision Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="series_metrics.html">Series Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparative_analysis.html">Comparative Analysis</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Bifurcated Neural Network</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="bifurcated-neural-network">
<h1>Bifurcated Neural Network<a class="headerlink" href="#bifurcated-neural-network" title="Link to this heading">#</a></h1>
<p>The neural network method offers a deep learning-based approach to constructing house price indices. It automatically learns complex, nonlinear relationships between property features and sale prices, enabling it to separate individual property effects from broader market trends. While it requires large volumes of sales and property data, it is particularly powerful at scale and can produce accurate, fine-grained, and timely indices without relying on repeat sales.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Background on model construction for the neural network method can be found in:</p>
<p>Krause and Johnson (2024), “A Multi-Criteria Evaluation of House Price Indexes”. <a class="github reference external" href="https://github.com/andykrause/hpi_research/tree/master/papers/hpi_comp">andykrause/hpi_research</a>.</p>
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The neural network method:</p>
<ol class="arabic simple">
<li><p>Separates property-specific and market-level effects</p></li>
<li><p>Learns nonlinear relationships automatically</p></li>
<li><p>Can handle high-dimensional feature spaces</p></li>
<li><p>Supports both local and global market patterns</p></li>
</ol>
<p>The method supports two distinct approaches for extracting the house price index:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 40.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Residual Approach</p></th>
<th class="head"><p>Attributional Approach</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Extracts the index directly from the market pathway by isolating temporal market effects. Default in <cite>hpiPy</cite>.</p></td>
<td><p>Uses explainability techniques (e.g., SHAP) to attribute prediction components to market-level factors.</p></td>
</tr>
<tr class="row-odd"><td><p>Steps</p></td>
<td><ol class="arabic simple">
<li><p>Train on full feature set</p></li>
<li><p>Zero out non-market (i.e., property-specific) features</p></li>
<li><p>Extract residual market effects</p></li>
<li><p>Convert to index</p></li>
</ol>
</td>
<td><ol class="arabic simple">
<li><p>Train on full feature set</p></li>
<li><p>Apply explainability techniques to assign feature attributions</p></li>
<li><p>Extract market-level attributions</p></li>
<li><p>Convert to index</p></li>
</ol>
</td>
</tr>
<tr class="row-even"><td><p>Benefits</p></td>
<td><ul class="simple">
<li><p>Explicit separation of effects</p></li>
<li><p>Structural interpretation</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Granular effect decomposition</p></li>
<li><p>Feature-level interpretability</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Drawbacks</p></td>
<td><ul class="simple">
<li><p>Less flexible than attributional</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Relies on post-hoc attributions</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Attributional Approach</strong></p>
<p>The attributional approach decomposes the logarithm of a property’s value into a market-level price index and a property-specific component. This reflects the idea that housing value is jointly determined by market conditions and the characteristics of the property itself (<a class="reference external" href="https://lusk.usc.edu/research/working-papers/revisiting-past-revision-repeat-sales-and-hedonic-indexes-house-prices">Clapham et al.</a>):</p>
<div class="math notranslate nohighlight">
\[\log V_{it} = \log P_t + \log Q_i + \varepsilon_{it}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V_{it}\)</span> is the observed transaction price (or value) of property <em>i</em> at time <em>t</em>.</p></li>
<li><p><span class="math notranslate nohighlight">\(P_t\)</span> is the market-level price index at time <em>t</em>, common to all properties.</p></li>
<li><p><span class="math notranslate nohighlight">\(Q_i\)</span> is the time-invariant quality or quantity of property <em>i</em> (e.g., structural/locational attributes).</p></li>
<li><p><span class="math notranslate nohighlight">\(\varepsilon_{it}\)</span> is a residual term capturing idiosyncratic noise or omitted effects.</p></li>
</ul>
<p>This model is conceptually similar to hedonic or repeat-sales approaches, where market effects and property characteristics are disentangled. The index is derived by directly extracting the market-level estimates for each time period from the model and normalizing them to a base period.</p>
<p><strong>Residual Approach</strong></p>
<p>The residual approach models the house price as a black-box prediction that integrates market and property factors, and then uses explainability methods to decompose this prediction into attributions. Specifically, DeepLIFT attributes the model output to individual features relative to a reference (baseline) input (<a class="reference external" href="https://arxiv.org/abs/1704.02685">Shrikumar et al.</a>):</p>
<div class="math notranslate nohighlight">
\[\hat{V}_i = f(x_i)\]</div>
<div class="math notranslate nohighlight">
\[\Delta \hat{V}_i = \hat{V}_i - \hat{V}_i^{\text{ref}} = \sum_{j} C_j\]</div>
<div class="math notranslate nohighlight">
\[C_j = m_j \cdot \Delta x_{ij}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{V}_i = f(x_i)\)</span> is the model’s predicted value for property <em>i</em>.</p></li>
<li><p><span class="math notranslate nohighlight">\(x_i\)</span> is the feature vector describing property <em>i</em> (e.g., square footage, year built, etc.).</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{V}_i^{\text{ref}} = f(x_i^{\text{ref}})\)</span> is the prediction for a baseline (e.g., average, median, or zeroed) property.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta \hat{V}_i\)</span> is the total difference in predicted value from the baseline.</p></li>
<li><p><span class="math notranslate nohighlight">\(C_j\)</span> is the contribution of feature <span class="math notranslate nohighlight">\(j\)</span>, computed as the product of the feature’s difference from baseline, <span class="math notranslate nohighlight">\(\Delta x_{ij} = x_{ij} - x_{j}^{\text{ref}}\)</span>, and its multiplier <span class="math notranslate nohighlight">\(m_j\)</span>, which represents the sensitivity of the output to that feature.</p></li>
</ul>
<p>This approach allows for interpretability of complex nonlinear models by expressing the prediction in terms of feature-level contributions. The index is derived by estimating the attributions for the temporal features at each time period and normalizing them to a base period.</p>
</section>
<section id="data-preparation">
<h2>Data Preparation<a class="headerlink" href="#data-preparation" title="Link to this heading">#</a></h2>
<p>Required data structure:</p>
<ul class="simple">
<li><p>A date column (e.g., “sale_date”)</p></li>
<li><p>A price column (e.g., “sale_price”)</p></li>
<li><p>Property characteristics</p></li>
<li><p>A transaction identifier</p></li>
</ul>
<p>Example setup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hpipy.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_ex_sales</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hpipy.period_table</span><span class="w"> </span><span class="kn">import</span> <span class="n">PeriodTable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hpipy.trans_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">HedonicTransactionData</span>

<span class="go"># Load sales data.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_ex_sales</span><span class="p">()</span>

<span class="go"># Create period table.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sales_hdata</span> <span class="o">=</span> <span class="n">PeriodTable</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">create_period_table</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;sale_date&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">periodicity</span><span class="o">=</span><span class="s2">&quot;monthly&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>

<span class="go"># Prepare hedonic data.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_data</span> <span class="o">=</span> <span class="n">HedonicTransactionData</span><span class="p">(</span><span class="n">sales_hdata</span><span class="p">)</span><span class="o">.</span><span class="n">create_transactions</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">prop_id</span><span class="o">=</span><span class="s2">&quot;pinx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">trans_id</span><span class="o">=</span><span class="s2">&quot;sale_id&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">price</span><span class="o">=</span><span class="s2">&quot;sale_price&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="creating-the-index">
<h2>Creating the Index<a class="headerlink" href="#creating-the-index" title="Link to this heading">#</a></h2>
<p>Create a neural network-based index using either approach:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hpipy.extensions</span><span class="w"> </span><span class="kn">import</span> <span class="n">NeuralNetworkIndex</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;prop_id&quot;</span><span class="p">:</span> <span class="s2">&quot;pinx&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;trans_id&quot;</span><span class="p">:</span> <span class="s2">&quot;sale_id&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="s2">&quot;sale_price&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;sale_date&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;dep_var&quot;</span><span class="p">:</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;ind_var&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tot_sf&quot;</span><span class="p">,</span> <span class="s2">&quot;beds&quot;</span><span class="p">,</span> <span class="s2">&quot;baths&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s2">&quot;feature_dict&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;numerics&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="gp">... </span>        <span class="s2">&quot;log_numerics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tot_sf&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;categoricals&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="gp">... </span>        <span class="s2">&quot;ordinals&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;beds&quot;</span><span class="p">,</span> <span class="s2">&quot;baths&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;hpi&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sale_date&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="s2">&quot;preprocess_geo&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;random_seed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}</span>

<span class="go"># Create index using residual approach (default).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpi_residual</span> <span class="o">=</span> <span class="n">NeuralNetworkIndex</span><span class="o">.</span><span class="n">create_index</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">trans_data</span><span class="o">=</span><span class="n">trans_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="s2">&quot;residual&quot;</span><span class="p">,</span>  <span class="c1"># default</span>
<span class="gp">... </span>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>

<span class="go"># Create index using attributional approach.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hpi_attributional</span> <span class="o">=</span> <span class="n">NeuralNetworkIndex</span><span class="o">.</span><span class="n">create_index</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">trans_data</span><span class="o">=</span><span class="n">trans_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="s2">&quot;attributional&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h2>
<p>The main parameters for neural network index creation are:</p>
<div class="hint admonition">
<p class="admonition-title">Parameters</p>
<dl class="simple">
<dt><strong>dep_var</strong><span class="classifier">str</span></dt><dd><p>Dependent variable to model.</p>
</dd>
<dt><strong>ind_var</strong><span class="classifier">list</span></dt><dd><p>Independent variables to use in the model.</p>
</dd>
<dt><strong>estimator</strong><span class="classifier">str</span></dt><dd><p>Estimator type. Choose between:</p>
<ul class="simple">
<li><p>“residual”: Extracts index from market pathway (default)</p></li>
<li><p>“attributional”: Derives index through explainability analysis</p></li>
</ul>
</dd>
<dt><strong>feature_dict</strong><span class="classifier">dict</span></dt><dd><p>Feature dictionary specifying how different variables should be processed:</p>
<ul class="simple">
<li><p>numerics: Standard numeric features</p></li>
<li><p>log_numerics: Features to be log-transformed</p></li>
<li><p>categoricals: Categorical features for embedding</p></li>
<li><p>ordinals: Ordinal features</p></li>
<li><p>hpi: Temporal features for index generation</p></li>
</ul>
</dd>
<dt><strong>num_models</strong><span class="classifier">int</span></dt><dd><p>Number of models to train in ensemble.</p>
</dd>
<dt><strong>num_epochs</strong><span class="classifier">int</span></dt><dd><p>Number of training epochs.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier">int</span></dt><dd><p>Batch size for training.</p>
</dd>
<dt><strong>hidden_dims</strong><span class="classifier">list</span></dt><dd><p>List of integers specifying the number of neurons in each hidden layer.</p>
</dd>
<dt><strong>emb_size</strong><span class="classifier">int</span></dt><dd><p>Embedding size for categorical features.</p>
</dd>
<dt><strong>dropout_rate</strong><span class="classifier">float</span></dt><dd><p>Dropout rate for regularization (0 to 1).</p>
</dd>
<dt><strong>learning_rate</strong><span class="classifier">float</span></dt><dd><p>Learning rate for optimization.</p>
</dd>
</dl>
</div>
</section>
<section id="evaluating-the-index">
<h2>Evaluating the Index<a class="headerlink" href="#evaluating-the-index" title="Link to this heading">#</a></h2>
<p>Evaluate the neural network index using various metrics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hpipy.utils.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">volatility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">hpipy.utils.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_index</span>

<span class="go"># Calculate metrics.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vol_residual</span> <span class="o">=</span> <span class="n">volatility</span><span class="p">(</span><span class="n">hpi_residual</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vol_attributional</span> <span class="o">=</span> <span class="n">volatility</span><span class="p">(</span><span class="n">hpi_attributional</span><span class="p">)</span>

<span class="go"># Visualize the index.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span>
<span class="gp">... </span>        <span class="n">plot_index</span><span class="p">(</span><span class="n">hpi_residual</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">transform_calculate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;&#39;Residual&#39;&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;method:N&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Method&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span>
<span class="gp">... </span>        <span class="n">plot_index</span><span class="p">(</span><span class="n">hpi_attributional</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">transform_calculate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;&#39;Attributional&#39;&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;method:N&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Method&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">properties</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Neural Network Index&quot;</span><span class="p">)</span>
<span class="go">alt.LayerChart(...)</span>
</pre></div>
</div>

        <div class="altair-chart" id="container-vega-spec-7783bdd24f784905b35f733da2eef9ee">
            <script type="application/json" id="vega-spec-7783bdd24f784905b35f733da2eef9ee">
                {"$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "config": {"view": {"continuousHeight": 300, "continuousWidth": 300}}, "datasets": {"data-17f8834dad9c64a549c9c8f7362e61d5": [{"x": "2010-01-31T00:00:00", "y": 100.0}, {"x": "2010-02-28T00:00:00", "y": 101.1150131225586}, {"x": "2010-03-31T00:00:00", "y": 103.14756774902344}, {"x": "2010-04-30T00:00:00", "y": 104.90179443359375}, {"x": "2010-05-31T00:00:00", "y": 105.20189666748047}, {"x": "2010-06-30T00:00:00", "y": 106.25902557373047}, {"x": "2010-07-31T00:00:00", "y": 107.59943389892578}, {"x": "2010-08-31T00:00:00", "y": 107.19085693359375}, {"x": "2010-09-30T00:00:00", "y": 104.60334777832031}, {"x": "2010-10-31T00:00:00", "y": 102.57585906982422}, {"x": "2010-11-30T00:00:00", "y": 101.2969970703125}, {"x": "2010-12-31T00:00:00", "y": 99.20348358154297}, {"x": "2011-01-31T00:00:00", "y": 98.02627563476562}, {"x": "2011-02-28T00:00:00", "y": 99.11851501464844}, {"x": "2011-03-31T00:00:00", "y": 101.627685546875}, {"x": "2011-04-30T00:00:00", "y": 103.26591491699219}, {"x": "2011-05-31T00:00:00", "y": 104.11116790771484}, {"x": "2011-06-30T00:00:00", "y": 105.40946960449219}, {"x": "2011-07-31T00:00:00", "y": 107.15861511230469}, {"x": "2011-08-31T00:00:00", "y": 107.0791244506836}, {"x": "2011-09-30T00:00:00", "y": 105.77227020263672}, {"x": "2011-10-31T00:00:00", "y": 104.66649627685547}, {"x": "2011-11-30T00:00:00", "y": 103.90616607666016}, {"x": "2011-12-31T00:00:00", "y": 101.75910186767578}, {"x": "2012-01-31T00:00:00", "y": 100.73505401611328}, {"x": "2012-02-29T00:00:00", "y": 100.85088348388672}, {"x": "2012-03-31T00:00:00", "y": 102.5187759399414}, {"x": "2012-04-30T00:00:00", "y": 103.61837005615234}, {"x": "2012-05-31T00:00:00", "y": 104.958740234375}, {"x": "2012-06-30T00:00:00", "y": 107.53502655029297}, {"x": "2012-07-31T00:00:00", "y": 109.54337310791016}, {"x": "2012-08-31T00:00:00", "y": 109.81919860839844}, {"x": "2012-09-30T00:00:00", "y": 110.30171203613281}, {"x": "2012-10-31T00:00:00", "y": 111.8499984741211}, {"x": "2012-11-30T00:00:00", "y": 112.61804962158203}, {"x": "2012-12-31T00:00:00", "y": 112.08175659179688}, {"x": "2013-01-31T00:00:00", "y": 111.01864624023438}, {"x": "2013-02-28T00:00:00", "y": 111.43453979492188}, {"x": "2013-03-31T00:00:00", "y": 113.44017028808594}, {"x": "2013-04-30T00:00:00", "y": 114.65169525146484}, {"x": "2013-05-31T00:00:00", "y": 116.05390167236328}, {"x": "2013-06-30T00:00:00", "y": 118.13587188720703}, {"x": "2013-07-31T00:00:00", "y": 118.50816345214844}, {"x": "2013-08-31T00:00:00", "y": 117.70148468017578}, {"x": "2013-09-30T00:00:00", "y": 117.56784057617188}, {"x": "2013-10-31T00:00:00", "y": 118.3990249633789}, {"x": "2013-11-30T00:00:00", "y": 117.923583984375}, {"x": "2013-12-31T00:00:00", "y": 116.40154266357422}, {"x": "2014-01-31T00:00:00", "y": 115.60588073730469}, {"x": "2014-02-28T00:00:00", "y": 116.67721557617188}, {"x": "2014-03-31T00:00:00", "y": 119.53858947753906}, {"x": "2014-04-30T00:00:00", "y": 123.50224304199219}, {"x": "2014-05-31T00:00:00", "y": 126.11474609375}, {"x": "2014-06-30T00:00:00", "y": 128.05880737304688}, {"x": "2014-07-31T00:00:00", "y": 127.71858215332031}, {"x": "2014-08-31T00:00:00", "y": 126.65171813964844}, {"x": "2014-09-30T00:00:00", "y": 126.32115936279297}, {"x": "2014-10-31T00:00:00", "y": 126.90302276611328}, {"x": "2014-11-30T00:00:00", "y": 127.65339660644531}, {"x": "2014-12-31T00:00:00", "y": 127.87451934814453}, {"x": "2015-01-31T00:00:00", "y": 127.4740219116211}, {"x": "2015-02-28T00:00:00", "y": 127.96064758300781}, {"x": "2015-03-31T00:00:00", "y": 131.29685974121094}, {"x": "2015-04-30T00:00:00", "y": 136.1217803955078}, {"x": "2015-05-31T00:00:00", "y": 139.7487335205078}, {"x": "2015-06-30T00:00:00", "y": 140.66822814941406}, {"x": "2015-07-31T00:00:00", "y": 140.9882354736328}, {"x": "2015-08-31T00:00:00", "y": 140.45187377929688}, {"x": "2015-09-30T00:00:00", "y": 139.7003631591797}, {"x": "2015-10-31T00:00:00", "y": 138.7366485595703}, {"x": "2015-11-30T00:00:00", "y": 138.47972106933594}, {"x": "2015-12-31T00:00:00", "y": 139.7919464111328}, {"x": "2016-01-31T00:00:00", "y": 142.42593383789062}, {"x": "2016-02-29T00:00:00", "y": 145.81329345703125}, {"x": "2016-03-31T00:00:00", "y": 149.6857452392578}, {"x": "2016-04-30T00:00:00", "y": 153.4259490966797}, {"x": "2016-05-31T00:00:00", "y": 155.6547393798828}, {"x": "2016-06-30T00:00:00", "y": 157.17654418945312}, {"x": "2016-07-31T00:00:00", "y": 157.6016845703125}, {"x": "2016-08-31T00:00:00", "y": 156.1923065185547}, {"x": "2016-09-30T00:00:00", "y": 154.04202270507812}, {"x": "2016-10-31T00:00:00", "y": 151.66773986816406}, {"x": "2016-11-30T00:00:00", "y": 150.46817016601562}, {"x": "2016-12-31T00:00:00", "y": 151.87506103515625}], "data-ccd544e5edb8e025cb2b0be5a676a8fb": [{"x": "2010-01-31T00:00:00", "y": 100.0}, {"x": "2010-02-28T00:00:00", "y": 101.11246154093682}, {"x": "2010-03-31T00:00:00", "y": 103.57156241234784}, {"x": "2010-04-30T00:00:00", "y": 105.57400111795545}, {"x": "2010-05-31T00:00:00", "y": 105.04333799830643}, {"x": "2010-06-30T00:00:00", "y": 106.05901840539951}, {"x": "2010-07-31T00:00:00", "y": 106.9650433916738}, {"x": "2010-08-31T00:00:00", "y": 106.65918528629103}, {"x": "2010-09-30T00:00:00", "y": 104.37016727185508}, {"x": "2010-10-31T00:00:00", "y": 101.66411070357142}, {"x": "2010-11-30T00:00:00", "y": 100.16171592155581}, {"x": "2010-12-31T00:00:00", "y": 98.58282169459004}, {"x": "2011-01-31T00:00:00", "y": 97.87319667568416}, {"x": "2011-02-28T00:00:00", "y": 99.40738863620035}, {"x": "2011-03-31T00:00:00", "y": 102.08811927314505}, {"x": "2011-04-30T00:00:00", "y": 104.13377697056794}, {"x": "2011-05-31T00:00:00", "y": 104.70341178109044}, {"x": "2011-06-30T00:00:00", "y": 105.43990558394304}, {"x": "2011-07-31T00:00:00", "y": 106.12912559705457}, {"x": "2011-08-31T00:00:00", "y": 106.24236210974057}, {"x": "2011-09-30T00:00:00", "y": 105.4581636023032}, {"x": "2011-10-31T00:00:00", "y": 104.62893515170855}, {"x": "2011-11-30T00:00:00", "y": 104.43416058001387}, {"x": "2011-12-31T00:00:00", "y": 101.98803789631603}, {"x": "2012-01-31T00:00:00", "y": 101.12379369525166}, {"x": "2012-02-29T00:00:00", "y": 101.74698699399273}, {"x": "2012-03-31T00:00:00", "y": 103.95911168343295}, {"x": "2012-04-30T00:00:00", "y": 105.42518157632767}, {"x": "2012-05-31T00:00:00", "y": 106.61035952441044}, {"x": "2012-06-30T00:00:00", "y": 108.2346928316363}, {"x": "2012-07-31T00:00:00", "y": 108.75303356011852}, {"x": "2012-08-31T00:00:00", "y": 109.34950007184652}, {"x": "2012-09-30T00:00:00", "y": 110.44519964079103}, {"x": "2012-10-31T00:00:00", "y": 112.88327857480398}, {"x": "2012-11-30T00:00:00", "y": 113.21638633931099}, {"x": "2012-12-31T00:00:00", "y": 113.3055582689682}, {"x": "2013-01-31T00:00:00", "y": 112.97955634884865}, {"x": "2013-02-28T00:00:00", "y": 113.82347063127452}, {"x": "2013-03-31T00:00:00", "y": 116.8288933983001}, {"x": "2013-04-30T00:00:00", "y": 117.9719059369148}, {"x": "2013-05-31T00:00:00", "y": 118.25091530274459}, {"x": "2013-06-30T00:00:00", "y": 119.55904068331733}, {"x": "2013-07-31T00:00:00", "y": 118.68819529056307}, {"x": "2013-08-31T00:00:00", "y": 116.26177370553452}, {"x": "2013-09-30T00:00:00", "y": 117.6757088730517}, {"x": "2013-10-31T00:00:00", "y": 118.64012991098807}, {"x": "2013-11-30T00:00:00", "y": 118.87663899486134}, {"x": "2013-12-31T00:00:00", "y": 118.01741593364639}, {"x": "2014-01-31T00:00:00", "y": 117.68162930158232}, {"x": "2014-02-28T00:00:00", "y": 119.39297300650334}, {"x": "2014-03-31T00:00:00", "y": 122.84095311764469}, {"x": "2014-04-30T00:00:00", "y": 126.7285023662164}, {"x": "2014-05-31T00:00:00", "y": 128.69417436629104}, {"x": "2014-06-30T00:00:00", "y": 129.61719724447693}, {"x": "2014-07-31T00:00:00", "y": 127.9798825107138}, {"x": "2014-08-31T00:00:00", "y": 125.96664007538703}, {"x": "2014-09-30T00:00:00", "y": 125.69198690213537}, {"x": "2014-10-31T00:00:00", "y": 127.41109250630167}, {"x": "2014-11-30T00:00:00", "y": 129.36667862883843}, {"x": "2014-12-31T00:00:00", "y": 129.67004819265247}, {"x": "2015-01-31T00:00:00", "y": 129.50439680143194}, {"x": "2015-02-28T00:00:00", "y": 131.15195836200616}, {"x": "2015-03-31T00:00:00", "y": 135.87304039865387}, {"x": "2015-04-30T00:00:00", "y": 140.11759311072012}, {"x": "2015-05-31T00:00:00", "y": 142.7884496844344}, {"x": "2015-06-30T00:00:00", "y": 142.1371785916073}, {"x": "2015-07-31T00:00:00", "y": 141.68134484790164}, {"x": "2015-08-31T00:00:00", "y": 139.69472621309328}, {"x": "2015-09-30T00:00:00", "y": 140.00542857413149}, {"x": "2015-10-31T00:00:00", "y": 138.83492563889874}, {"x": "2015-11-30T00:00:00", "y": 140.4229686822511}, {"x": "2015-12-31T00:00:00", "y": 142.68736217811494}, {"x": "2016-01-31T00:00:00", "y": 146.562054103286}, {"x": "2016-02-29T00:00:00", "y": 150.0982758948726}, {"x": "2016-03-31T00:00:00", "y": 154.49096930071957}, {"x": "2016-04-30T00:00:00", "y": 158.65758682775382}, {"x": "2016-05-31T00:00:00", "y": 159.08074587384073}, {"x": "2016-06-30T00:00:00", "y": 159.9584772260187}, {"x": "2016-07-31T00:00:00", "y": 159.95665169993336}, {"x": "2016-08-31T00:00:00", "y": 158.10153413735748}, {"x": "2016-09-30T00:00:00", "y": 154.917071614509}, {"x": "2016-10-31T00:00:00", "y": 152.89406942152112}, {"x": "2016-11-30T00:00:00", "y": 151.7878577880982}, {"x": "2016-12-31T00:00:00", "y": 153.54786694979117}]}, "height": 300, "layer": [{"data": {"name": "data-17f8834dad9c64a549c9c8f7362e61d5"}, "encoding": {"color": {"field": "method", "title": "Method", "type": "nominal"}, "tooltip": [{"field": "x", "title": "Time Period", "type": "temporal"}, {"field": "y", "format": ".3f", "title": "Index Value", "type": "quantitative"}], "x": {"axis": {"format": "%Y", "labelAngle": 0, "title": "Time Period", "values": ["2010-01-31T00:00:00.000000000", "2011-01-31T00:00:00.000000000", "2012-01-31T00:00:00.000000000", "2013-01-31T00:00:00.000000000", "2014-01-31T00:00:00.000000000", "2015-01-31T00:00:00.000000000", "2016-01-31T00:00:00.000000000"]}, "field": "x", "type": "temporal"}, "y": {"field": "y", "scale": {"zero": false}, "title": "Index Value", "type": "quantitative"}}, "mark": {"size": 4, "type": "line"}, "transform": [{"as": "method", "calculate": "'Residual'"}]}, {"data": {"name": "data-ccd544e5edb8e025cb2b0be5a676a8fb"}, "encoding": {"color": {"field": "method", "title": "Method", "type": "nominal"}, "tooltip": [{"field": "x", "title": "Time Period", "type": "temporal"}, {"field": "y", "format": ".3f", "title": "Index Value", "type": "quantitative"}], "x": {"axis": {"format": "%Y", "labelAngle": 0, "title": "Time Period", "values": ["2010-01-31T00:00:00.000000000", "2011-01-31T00:00:00.000000000", "2012-01-31T00:00:00.000000000", "2013-01-31T00:00:00.000000000", "2014-01-31T00:00:00.000000000", "2015-01-31T00:00:00.000000000", "2016-01-31T00:00:00.000000000"]}, "field": "x", "type": "temporal"}, "y": {"field": "y", "scale": {"zero": false}, "title": "Index Value", "type": "quantitative"}}, "mark": {"size": 4, "type": "line"}, "transform": [{"as": "method", "calculate": "'Attributional'"}]}], "title": "Neural Network Index", "width": 500}
            </script>
            <script>
                (function() {
                    const el = document.getElementById("vega-spec-7783bdd24f784905b35f733da2eef9ee");
                    if (el) {
                        const spec = JSON.parse(el.textContent);
                        vegaEmbed(el.parentElement, spec, {
                            actions: {
                                export: true,
                                source: true,
                                editor: true,
                                compiled: false
                            }
                        }).catch(console.error);
                    }
                })();
            </script>
        </div>
        </section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="random_forest.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Interpretable Random Forest</p>
      </div>
    </a>
    <a class="right-next"
       href="accuracy_metrics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Accuracy Metrics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data Preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-the-index">Creating the Index</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters">Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-index">Evaluating the Index</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user_guide/neural_network.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>